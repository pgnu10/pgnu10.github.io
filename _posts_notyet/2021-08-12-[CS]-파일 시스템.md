---
title: '[CS] 운영체제: 파일 시스템'
excerpt: 파일 시스템에 대해 알아봅니다.
categories:
  - Computer Science
tags:
  - 기술면접 준비
  - 운영체제
  - 파일 시스템
  - 커널 영역
  - 유저 영역
  - FAT
  - ZFS
  - 비전공자를 위한
toc: true
toc_sticky: true
date: '2021-08-12'
lastmod: '2022-01-16'
---

# 파일 시스템 File System

컴퓨터의 모든 프로그램은 파일로 구성되어 있고, 파일을 사용합니다. 따라서 필요한 파일에 쉽게 접근할 수 있도록 파일을 관리하는 방법이 필요합니다. 파일을 관리하는 방법, 체계를 파일 시스템이라고 합니다.

파일 시스템, 컴퓨터에서는 파일을 저장하는 트리 구조의 저장 체계 사용합니다. 계층적으로 파일을 저장하면 목적에 따른 분류가 쉽고, 효율적으로 관리할 수 있기 때문입니다.

- 디렉토리 (Directory): 흔히 폴더라고 불립니다. 파일과 다른 디렉토리를 포함할 수 있습니다.
- 파일 (File): 컴퓨터에서 정보를 저장하는 논리적인 단위로, {파일명.식별자} 형식으로 저장됩니다. (e.g. `hello.txt`)

파일 시스템은 root 디렉토리로부터 시작하는 트리 구조로 되어 있습니다. 트리 구조에서 파일이 위치한 곳은 경로를 통해 표현할 수 있습니다.

- root 디렉토리는 windows의 경우 C 드라이브이고, Mac의 경우 root입니다.
- 경로: 파일의 고유한 위치. 트리 구조상 노드의 연결
  - 절대 경로: 루트 디렉토리로부터 파일 위치까지의 경로 (C:/user/docs/somefile.txt)
  - 상대 경로: 현재 있는 디렉토리(working directory)로부터 타깃 파일까지의 경로 (./somefile.txt)

## 파일 시스템의 특징

- 계층적 디렉토리 구조로 파일을 저장하는 체계입니다.
- **커널 영역**에서 동작합니다.
- 파일 CRUD(Create, Read, Update, Delete)을 원활히 수행하기 위함입니다.
- 디스크 파티션(= C 드라이브, D 드라이브)별로 하나씩 둘 수 있습니다.

### 커널 영역과 유저 영역

#### 유저 영역

프로그램이 동작하기 위해 사용되는 메모리 공간(코드 영역, 데이터 영역, 스택 및 힙 영역)을 가리켜 유저 영역이라고 합니다.

응용프로그램이 실행되는 기본 장소로, 물리적인 영역으로의 접근이 허용되지 않으며 접근할 수 있는 메모리의 영역에도 제한이 따릅니다.

#### 커널 영역

하나의 프로세스에 할당되는 총 메모리 공간 중에서 유저 영역을 제외한 나머지 영역을 커널 영역이라고 합니다.

운영체제가 실행되기 위해서는 운영체제 역시 메모리에 올라가야 하고, 변수 선언도 하고 필요한 메모리를 동적 할당하기도 합니다.

이렇게 운영체제라는 하나의 소프트웨어를 실행시키기 위해서 필요한 메모리 공간을 커널(Kernel 영역)이라 합니다.

운영체제가 실행될 때의 모드로, 메모리뿐만 아니라 하드웨어의 접근에도 제한이 따르지 않습니다.

#### Windows의 두가지 프로세서 접근 모드

유저 어플리케이션이 운영체제의 치명적인 데이터에 접근하여 수정하거나 삭제하지 못하게 막기 위해 윈도우는 두가지 프로세서 접근 모드를 지원합니다.

유저 어플리케이션은 유저 모드에서만 실행되고, 운영체제 코드 (시스템 서비스와 디바이스 드라이버)는 커널 모드에서 실행이 됩니다. 커널 모드는 모든 시스템 메모리와 모든 CPU 인스트럭션에 접근이 허가된 프로세스 실행 모드입니다.

즉 프로세서는 유저 모드보다 커널 모드에 높은 권한을 줌으로써 오작동을 유발하는 유저 어플리케이션이 시스템 전체의 안정성을 해치지 않게 보장하는 필수 기반을 제공합니다.

따라서 하나의 프로세스에 할당되는 메모리 공간을 나누어서, 일부 영역은 어플리케이션 프로그램 코드를 올리는데 사용하고 또 일부는 운영체제를 실행하는 과정에서 변수 선언이나 메모리의 동적 할당 등의 용도로 사용하는 것입니다.

## 파일 시스템의 역할

- 파일 관리: 파일 저장, 참조, 공유
- 보조 저장소 관리: 저장 공간 할당
- 파일 무결성 메커니즘: 파일이 의도한 정보만 포함하고 있도록 합니다.
- 접근 방법: 저장된 데이터에 접근할 수 있는 방법을 제공합니다.

## 파일 시스템의 구조

- 메타 영역: 데이터 영역에 기록된 파일의 이름, 위치, 크기, 시간정보, 삭제유무 등 파일의 정보를 담고 있는 영역입니다. 윈도우 탐색기를 이용해 파일을 검색할 때 이 영역을 탐색하면서 파일을 찾습니다.
- 데이터 영역: 파일의 데이터가 저장되어 있는 영역입니다.

## 파일 시스템의 종류

### FAT (File Allocation Table)

- 빌 게이츠와 마크 맥도널드가 개발한 파일 시스템입니다. 버전에 따라 FAT12, FAT16, FAT32, exFAT 등이 있습니다.
- 어느 영역에 파일이 속해 있는지, 공간에 여유가 있는지 등에 대한 정보를 중심으로 하는 색인표 (Table)을 이용합니다.
- 상대적으로 간단한 디자인을 가지고 있습니다. 그 덕에 대부분의 OS에서는 FAT를 지원하기 때문에 데이터 전송이 편리합니다. 메모리 카드나 플래시 메모리, 이동식 장치 등이 FAT를 지원하기에 이동성 측면에서는 편리하지만 안전성 측면에서는 그만큼 불리합니다.
- 단순 연결 리스트(Singly Linked List)를 이용해서 구현합니다.

### HFS (Hierarchical File System)

- Apple이 1985년 개발한 파일 시스템입니다. 
- MAC OS에서 현재는 지원이 종료되었으며, 대신 더 업그레이된 버전인 HFS+, APFS가 사용됩니다.

### ZFS (Zettabyte File System)

- 2005년 처음 소개된 유닉스 파일 시스템으로, 최초로 128비트 파일 시스템을 적용하여 최대 256 제타 바이트 (1 제타 바이트 = 10 억 테라 바이트)의 볼륨 크기 용량을 제공하는 파일 시스템입니다. 
- 네트워크 지원 (iSCSI, CIFS, NFS), SSD 캐시 지원, 자체 RAID 지원, Pool 기능 지원, Silent Corruption 방지 등의 강력한 기능을 지원합니다.

### 그 외

다양한 파일 시스템이 존재합니다.
- Microsoft: FAT, NTFS, ReFS
- Apple: HFS, HFS+, APFS
- Linux/Unix: ext, Btrfs, F2Fs, XFS, ZFS

## 참고자료

<details><summary>펼치기</summary>
<div markdown="1">

- https://ko.wikipedia.org/wiki/%ED%8C%8C%EC%9D%BC_%EC%8B%9C%EC%8A%A4%ED%85%9C
- https://security-nanglam.tistory.com/228
- https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/File%20System.md
- https://namu.wiki/w/FAT
- 
</div>
</details>
